{% extends 'base.html' %}
{% load bootstrap4 %}
{% load static %}
{% load index %}
{% block content %}
  <style>
  .container-login100 {
}

.container-login100::before {
  content: "";
  background-color: rgba(255, 255, 255, 1.0);
}

.toggles {
   width: 300px;
   margin: 127px auto;
   background: 1px solid black;
   transition: scale(0.5);
}

.toggle-border {
   width: 300px;
   height: 80px;
   border: 2px solid #f0ebeb;
   border-radius: 130px;
   margin-bottom: 45px;
   padding: 25px;
   background: linear-gradient(to bottom right, white, rgba(220,220,220,.5)), white;
   box-shadow: 0 0 0 2px #fbfbfb;
   cursor: pointer;
}

.toggle-border:last-child {
   margin-bottom: 0;
}

input[type="checkbox"] {
   display: none;
}

label {
   position: relative;
   display: inline-block;
   width: 300px;
   height: 80px;
   background: #d13613;
   border-radius: 80px;
   cursor: pointer;
   box-shadow: inset 0 0 16px rgba(0,0,0,.3);
   transition: background .5s;
}

label:after,
label:before {
   content: "";
   position: absolute;
   top: 25px;
   left: -100px;
   width: 20px;
   height: 20px;
   border: 2px solid #f0ebeb;
   border-radius: 50%;
   box-shadow: 0 0 0 1px #fbfbfb, inset 1px 3px 6px rgba(0,0,0,.3);
   background: #d13613;
   transition: background .5s;
}

label:before {
   left: calc(100% + 100px - 20px);
   background: #d1cac9;
}

input[type="checkbox"]:checked + label {
   background: #13d162;
}

.handle {
   position: absolute;
   top: -15px;
   left: -5px;
   width: 110px;
   height: 110px;
   border: 1px solid #e5e5e5;
   background: repeating-radial-gradient(circle at 50% 50%, rgba(200,200,200,.2) 0%, rgba(200,200,200,.2) 2%, transparent 2%, transparent 3%, rgba(200,200,200,.2) 3%, transparent 3%), conic-gradient(white 0%, silver 10%, white 35%, silver 45%, white 60%, silver 70%, white 80%, silver 95%, white 100%);
   border-radius: 50%;
   box-shadow: 3px 5px 10px 0 rgba(0,0,0,.4);
   transition: left .4s;
}

input[type="checkbox"]:checked + label > .handle {
   left: calc(100% - 110px + 5px);
}

input[type="checkbox"]:checked + label:after {
   background: #d1cac9;
}

input[type="checkbox"]:checked + label:before {
   background: #13d162;
}

.main{
   font-size:80px;
}

.preloader-scan {
	 position: fixed;
	 left: 0;
	 right: 0;
	 max-width: 400px;
	 display: table;
	 margin: 0 auto;
	 height: 100%;
	 text-align: center;
}
 .preloader-scan li:nth-child(1) {
	 width: 8px;
}
 .preloader-scan li:nth-child(2) {
	 width: 11px;
}
 .preloader-scan li:nth-child(3) {
	 width: 11px;
}
 .preloader-scan li:nth-child(4) {
	 width: 7px;
}
 .preloader-scan li:nth-child(5) {
	 width: 10px;
}
 .preloader-scan li:nth-child(6) {
	 width: 7px;
}
 .preloader-scan li:nth-child(7) {
	 width: 7px;
}
 .preloader-scan li:nth-child(8) {
	 width: 10px;
}
 .preloader-scan li:nth-child(9) {
	 width: 10px;
}
 .preloader-scan li:nth-child(10) {
	 width: 7px;
}
 .preloader-scan li:nth-child(11) {
	 width: 10px;
}
 .preloader-scan li:nth-child(12) {
	 width: 11px;
}
 .preloader-scan li:nth-child(13) {
	 width: 7px;
}
 .preloader-scan li:nth-child(14) {
	 width: 8px;
}
 .preloader-scan li:nth-child(15) {
	 width: 8px;
}
 .preloader-scan li:nth-child(16) {
	 width: 5px;
}
 .preloader-scan li:nth-child(17) {
	 width: 7px;
}
 .preloader-scan li:nth-child(18) {
	 width: 7px;
}
 .preloader-scan li:nth-child(19) {
	 width: 10px;
}
 .preloader-scan li:nth-child(20) {
	 width: 5px;
}
 .preloader-scan li:nth-child(21) {
	 width: 8px;
}
 .preloader-scan li:nth-child(22) {
	 width: 10px;
}
 .preloader-scan li:nth-child(23) {
	 width: 8px;
}
 .preloader-scan li:nth-child(24) {
	 width: 7px;
}
 .preloader-scan ul {
	 height: 100%;
	 display: table-cell;
	 list-style-type: none;
	 text-align: center;
}
 .preloader-scan li {
	 display: inline-block;
	 width: 2px;
	 height: 80px;
	 background-color: #444;
}
 .preloader-scan .laser {
	 width: 100%;
	 margin-left: -7%;
	 background-color: tomato;
    position:absolute;
    top:0%;
	 height: 2px;
	 z-index: 2;
	 box-shadow: 0 0 4px red;
	 animation: scanning 3s infinite;
}
 @keyframes beam {
	 50% {
		 opacity: 0;
	}
}
 @keyframes scanning {
	 50% {
		 transform: translateY(80px);
	}
}
 
 /* Chrome, Safari, Edge, Opera */
input::-webkit-outer-spin-button,
input::-webkit-inner-spin-button {
  -webkit-appearance: none;
  margin: 0;
}

/* Firefox */
input[type=number] {
  -moz-appearance: textfield;
}
{% if request.path == '/sec_home/manual' %}
input:focus {
    outline:none;
}
input{
   border:none;
}

.bord{
   border:2px solid black;
   border-radius : 6px;
   margin:20px;
   cursor:text;
}
.toggles{
   transfrom : scale(0.5) translate(-80%, 0%);
 -ms-transform: scale(0.5) translate(-80%, 0%); /* IE 9 */
 -webkit-transform: scale(0.5) translate(-100%, 0%);  /* Safari and Chrome */
 -o-transform: scale(0.5) translate(-70%, 0%); /* Opera */
 -moz-transform:scale(0.5) translate(-70%, 0%);
}

#toggles{
   margin: 5px auto;
}

.details{
   display:none;
   -webkit-transition:all 5s ease 0s;
}
</style>
<div style='margin:0 auto;width:500px;font-family: "Roboto Slab", serif;-webkit-transform:translate(20%, 0%);' id='parentdiv'>
<div style='display:inline-block;font-size:400px;-webkit-transition:font-size 0.5s ease 0s;' id='identer'>
   <b>S</b><input style='width:150px; line-height: 60px;' autofocus="autofocus" onfocus="this.select()"
		  						 id='search' autocomplete='off' type='number' onkeydown="return event.keyCode !== (69 || 189)" maxlength='6'
                          oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);" onkeydown=/>
</div>

      {% comment %} <img src='{% static "images/id.png"%}' style='display:inline-block;float:right;margin:30px' width='110px'/><br> {% endcomment %}
</div> 



{% else %}
</style>
<form align='center' style='margin:40px auto'>
   <input style='padding: 20px 10px; line-height: 110px;display:inline-block;font-size:100px;margin: 0 auto;width:40%;outline:none;border:0px' id='name' autofocus="autofocus" onfocus="this.select()"
		  						placeholder='Scan barcode' autocomplete='off' type='number' onkeydown="return event.keyCode !== (69 || 189)" maxlength='12'
                          oninput="javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);"/>
</form>
<div class='container'>
    {% if messages %}
    {% for m in messages %}
    {% if m.tags != 'info' %}
      <p class='main alert alert-{% if m.tags == "error" %}danger{% else %}{{ m.tags }}{% endif %}' align='center' width='30px'>{{m}}</p>
      {% else %}
      {{m|slice:':2'}}
         {% if m|slice:':2' == 'id'%}

            <img src="media/{{m|slice:'2:'}}"/>
         {% else %}
         <a href='/undo/{{m}}'>Undo</a>
         {% endif %}
      {% endif %}
   {% endfor %}
   {% if pinfo %}
   <div style='display:flex;margin-left:30px;justify-content: space-between;'>
                                 <div >
                                    <div style='display:inline'>
                                       <span style='font-size:4vw'>Name:</span><span style='font-size:4vw;font-weight:bold'>{{pinfo.full_name}}</span><br>
                                       <span style='font-size:3vw'>Year:</span><span style='font-size:3vw;font-weight:bold'>{{l.user.year|capfirst}}/{{l.user.branch|upper}}</span>&emsp;&emsp;&emsp;&emsp;
                                    </div>
                                    <div style='display:inline'>
                                       <span style='font-size:3vw;margin-top:2%'>Parent name:</span><span style='font-size:3vw;font-weight:bold'>{{pinfo.Parent_name|capfirst}}</span><br>
                                       <span style='font-size:3vw;margin-top:2%'>Parent no:</span><span style='font-size:3vw;font-weight:bold'>{{pinfo.Parent_phn_no}}</span>&emsp;&emsp;&emsp;&emsp;
                                       <span style='font-size:3vw;margin-top:2%'>City:</span><span style='font-size:3vw;font-weight:bold'>{{pinfo.city|capfirst}}</span>
                                    </div>
                                 </div>
                                    <img height='250px' src="{% static 'images/aa-min.jpg' %}" style='margin-right:80px'/>
                              </div>
   {% endif %}
   {% else %}
</div>
    <div class="preloader-scan">
  <ul>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    <li></li>
    
    <div class="diode">
      <div class="laser"></div>
    </div>
  </ul>
  
</div>
<br><br><br><br>
{% endif %}
{% endif %}  
    
{% if leaves or outings or request.path == '/sec_home/manual' %} 
<div class='details' ></div>

    {% if messages %}
    {% for m in messages %}<p class='alert alert-{% if m.tags == "error" %}danger{% else %}{{ m.tags }}{% endif %}' style='font-size:50px;margin:0 auto 130px auto;width:100%;position:fixed;bottom:0' align='center' width='50px'>{{m}}</p>{% endfor %}
   {% endif %}
   <div class="toggles"  id='toggles' style='bottom:0;left:50%;position:fixed;'>
   <p align='center' style='font-size:40px'>Manual</p>
         <div><input type="checkbox" id="two" unchecked />
         <label for="two">
            <div class="handle"  id='handle'></div>
         </label>
      </div>
   </div>
   {% else %}
   <div class="toggles">
   <p align='center' style='font-size:40px'>Manual</p>
         <input type="checkbox" id="two" checked />
         <label for="two">
            <div class="handle"  id='handle'></div>
         </label>
      </div>
   </div>
   {% endif %}
<script src="{% static 'jquery.min.js'%}"></script>
<script>
        $(document).ready(function(){
        $('.handle').click()
        {% if request.path == '/sec_home/' %}
        $('.toggles').on('click', function(){
                	location.replace('{% url "sec_home" "manual" %}');
        })
        {% else %}
        $('.toggles').on('click', function(){
                	location.replace('{% url "sec_home" %}');
        })
        {% endif %}
        $("#name").on("change keyup paste click", function(){
        		if ($('#name').val().length == 12){
                	var url_mask = '{% url "sec_home_aadhar" 1234 %}'.replace(/1234/, $(this).val());
                	location.replace(url_mask);
              };
        });
        $("#search").on("input", function(e) {
            var value = 'S'.concat($(this).val());

            {% comment %} $('tr').each(function(index) {
               if (index !== 0) {

                     $row = $(this);

                     var id = $row.find("td:eq(1)").text();

                     if (id.indexOf(value) !== 0) {
                        if (!($row.attr('id') === 'head')){
                           $row.hide();
                        }
                     }
                     else {
                        $row.show();
                     }
               }
            }); {% endcomment %}
            console.log(e.keycode);
            var evl = value.length-1;
            console.log(evl);
            if (value.length == 7){
               var html = '';
               for( var i=0; i<1; i++){
               {% for o in outings %}
                     console.log('{{o.user.id}}')
                     if('{{o.user.id}}' == value){
                        html=`<div class='' style='margin-left:30px;display:flex;'>
                              <div style='display:inline'>
                                 <h1 style='font-size:5vw;font-weight:strong;font-family: "Roboto Slab", serif;'>Outing</h1>
                                 {% if o.user.in_campus %}
                                 <a href="{% url 'out' 'o' o.pk %}"<Button class='btn btn-danger' style='width:14.5vw; height:10vh;font-size:3vw'>OUT</button></a>
                                 {% else %}
                                 <a href="{% url 'in' 'o' o.pk %}"<Button class='btn btn-success' style='width:14.5vw; height:10vh;font-size:3vw'>IN</button></a>
                                 {% endif %}
                              </div>
                              <table style='align-items:space-around;width:100%;margin:20px;margin-right:40px;display:inline'>
                              <thead style='display: table-header-group;font-family: "Roboto Slab", serif;'>
                              <tr style='font-size:3.5vw;'>
                                 <th class='text-center'>Reason</th>
                                 <th class='text-center'>Approved by</th>
                                 <th class='text-center'>Out time</th>
                                 <th class='text-center'>In time</th>
                              </tr>
                              </thead> 
                              <tbody>
                              <tr style='font-size:2.5vw;padding-left:10px;' align='center'>
                                 <td>{{o.reason}}</td>
                                 <td>Admin</td>
                                 <td>{{o.out_time}}</td>
                                 <td>{{o.in_time}}</td>
                              </tr>
                              </tbody>
                              </table>
                              </div>
                              <div style='display:flex;margin-left:30px;justify-content: space-between;'>
                                 <div >
                                    <div style='display:inline'>
                                       <span style='font-size:4vw'>Name:</span><span style='font-size:4vw;font-weight:bold'>Pinjarla Girish Satya Rahul</span><br>
                                       <span style='font-size:3vw'>Year:</span><span style='font-size:3vw;font-weight:bold'>CSE/E3</span>&emsp;&emsp;&emsp;&emsp;
                                    </div>
                                    <div style='display:inline'>
                                       <span style='font-size:3vw;margin-top:2%'>Parent name:</span><span style='font-size:3vw;font-weight:bold'>Satish Kumar</span><br>
                                       <span style='font-size:3vw;margin-top:2%'>Parent no:</span><span style='font-size:3vw;font-weight:bold'>9959819209</span>&emsp;&emsp;&emsp;&emsp;
                                       <span style='font-size:3vw;margin-top:2%'>City:</span><span style='font-size:3vw;font-weight:bold'>Eluru</span>
                                    </div>
                                 </div>
                                    <img height='250px' src="{% static 'images/aa-min.jpg' %}" style='margin-right:80px'/>
                              </div>`
                         break;
                     }
                     else{
                        html="<h1 style='font-size:5vw;color:red;font-weight:bold' align='center'>No Outing/Leave</h1>"
                     }
                     console.log(html);
                     console.log('{{forloop.counter}}')
               {% endfor %}
               {% for l in leaves %}
                     console.log('{{o.user.id}}')
                     if('{{l.user.id}}' == value){
                        html=`<div class='' style='margin-left:30px;display:flex;'>
                              <div style='display:inline'>
                                 <h1 style='font-size:5vw;font-family: "Roboto Slab", serif;'>Leave</h1>
                                 {% if l.user.in_campus %}
                                 <a href="{% url 'out' 'l' l.pk %}"<Button class='btn btn-danger' style='width:14.5vw; height:10vh;font-size:3vw'>OUT</button></a>
                                 {% else %}
                                 <a href="{% url 'in' 'l' l.pk %}"<Button class='btn btn-success' style='width:14.5vw; height:12vh;font-size:3vw'>IN</button></a>
                                 {% endif %}
                              </div>
                              <table style='align-items:space-around;width:100%;margin:20px;margin-right:40px;'>
                              <thead style='display: table-header-group;font-family: "Roboto Slab", serif;' >
                              <tr style='font-size:3.5vw;' align='center'>
                                 <th class='text-center'>Reason</th>
                                 <th class='text-center'>Approved by</th>
                                 <th class='text-center'>Out date</th>
                                 <th class='text-center'>In date</th>
                              </tr>
                              </thead> 
                              <tbody>
                              <tr style='font-size:2.5vw' align='center'>
                                 <td>{{l.reason}}</td>
                                 <td>Admin</td>
                                 <td>{{l.out_date|date:"d/m/y"}}</td>
                                 <td>{{l.in_date|date:"d/m/y"}}</td>
                              </tr>
                              </tbody>
                              </table>
                              </div>
                              <div style='display:flex;margin-left:30px;justify-content: space-between;'>
                                 <div >
                                    <div style='display:inline'>
                                    {% with pinfos|index:forloop.counter0 as pinfo %}
                                       <span style='font-size:4vw'>Name:</span><span style='font-size:4vw;font-weight:bold'>{{pinfo.full_name}}</span><br>
                                       <span style='font-size:3vw'>Year:</span><span style='font-size:3vw;font-weight:bold'>{{l.user.year|capfirst}}/{{l.user.branch|upper}}</span>&emsp;&emsp;&emsp;&emsp;
                                    </div>
                                    <div style='display:inline'>
                                       <span style='font-size:3vw;margin-top:2%'>Parent name:</span><span style='font-size:3vw;font-weight:bold'>{{pinfo.Parent_name|capfirst}}</span><br>
                                       <span style='font-size:3vw;margin-top:2%'>Parent no:</span><span style='font-size:3vw;font-weight:bold'>{{pinfo.Parent_phn_no}}</span>&emsp;&emsp;&emsp;&emsp;
                                       <span style='font-size:3vw;margin-top:2%'>City:</span><span style='font-size:3vw;font-weight:bold'>{{pinfo.city|capfirst}}</span>
                                    </div>
                                    {% endwith %}
                                 </div>
                                    <img height='250px' src="{% static 'images/aa-min.jpg' %}" style='margin-right:80px'/>
                              </div>`
                         break;
                     }
                     else{
                        html="<h1 style='font-size:5vw;color:red;font-weight:bold' align='center'>No Outing/Leave</h1>"
                     }
                     console.log(html);
                     console.log('{{forloop.counter}}')
               {% endfor %}
               {% if not outings and not leaves %}
                        html="<h1 style='font-size:5vw;color:red;font-weight:bold' align='center'>No Outing/Leave</h1>" 
               {% endif %}
               }
               $('.details').css({'display':'block'}).html(
                  html
               )
            }
            else{
               $('.details').css({'display':'none'})
            }
            console.log(value)
            var fontsize = 400-(50*evl);
            console.log(fontsize)
            $('#identer').css({'font-size':fontsize+'px'});
            var width = (value.length-1)*fontsize;
            console.log(width)
            if (evl!=0){
               $(this).css({'width':(value.length-1)*fontsize})
               $('#parentdiv').css({'width':fontsize+width});
            }
            $('.alert').css({'display':'none'})            
         });
         $('.bord').on('click', function(){
            $('#search').focus();
         })
         $('body').on('click', function(){
            $('#search').click();
         })
         
        });
</script>
{%endblock%}
